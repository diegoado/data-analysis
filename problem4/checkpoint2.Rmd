---
title: "Dados de opiniões sobre filmes"
output: html_document
---

```{r setup, include=FALSE}
library(dplyr)
library(ggplot2)
library(resample)

theme_set(theme_bw())
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
read <- function(file) {
  #' Lê um csv criado a partir dos dados de gastos dos deputados da
  require("readr")

  file = read_csv(file, col_types = list(.default = col_character()))
  return(file)
}

get_database <- function() {
  #' Trabalha os dados de forma mais convenientemente para resolver o problema.
  require("dplyr", warn.conflicts = FALSE)
  
  movies = read("../datasets/movies/movies.csv")
  rating = read("../datasets/movies/rating.csv")
  
  dataframe = rating %>% 
    select(-userId, -timestamp) %>% left_join(movies, by = c("movieId" = "movieId")) %>%
    rowwise() %>% mutate(countGen = length(unlist(strsplit(genres, '[|]'))))
  
  return(dataframe)
}

```

```{r}
database = get_database() %>% filter(grepl("Terminator", title))
```

